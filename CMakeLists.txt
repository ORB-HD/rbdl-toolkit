PROJECT ( RBDL-Toolkit )

CMAKE_MINIMUM_REQUIRED (VERSION 3.0)
LIST( APPEND CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR}/cmake )

# The QT Interface
SET( QT_USE_QTXML TRUE )
SET( QT_WRAP_CPP TRUE )
SET(CMAKE_AUTOMOC ON )
SET(CMAKE_AUTORCC ON )
SET(CMAKE_AUTOUIC ON )

SET(CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG} -DTOOLKIT_DEBUG")

FIND_PACKAGE (Qt5 REQUIRED COMPONENTS Core Gui Widgets 3DCore 3DExtras 3DRender 3DInput)
FIND_PACKAGE (RBDL COMPONENTS LUAMODEL REQUIRED)
FIND_PACKAGE (Eigen3 REQUIRED)
INCLUDE_DIRECTORIES (${QT_INCLUDE_DIR})
INCLUDE_DIRECTORIES (${CMAKE_CURRENT_BINARY_DIR})
INCLUDE_DIRECTORIES (${CMAKE_CURRENT_SOURCE_DIR})
INCLUDE_DIRECTORIES (${CMAKE_CURRENT_SOURCE_DIR}/include)
INCLUDE_DIRECTORIES (${CMAKE_CURRENT_BINARY_DIR}/include)
INCLUDE_DIRECTORIES (${CMAKE_CURRENT_BINARY_DIR}/ui)
INCLUDE_DIRECTORIES (${RBDL_INCLUDE_DIR})
INCLUDE_DIRECTORIES (${EIGEN3_INCLUDE_DIR})

ADD_DEFINITIONS (${QT_DEFINITIONS})

QT5_WRAP_UI ( UI_SRC
	ui/Timeline.ui
)

#Sources that contain q objects
QT5_WRAP_CPP ( MOC_SRCS
	include/ToolkitApp.h
	include/SceneWidget.h
	include/toolkit_interfaces.h
	include/Timeline.h
	include/rbdl_wrapper.h
)

SET ( Toolkit_SRCS
	src/ToolkitApp.cc
	src/Timeline.cc
	src/SceneWidget.cc
	src/main.cc
	src/util.cc
	src/render_util.cc
	src/rbdl_wrapper.cc
	src/toolkit_errors.cc
)

ADD_SUBDIRECTORY (
	plugins
)

ADD_EXECUTABLE ( rbdl-toolkit
	${Toolkit_SRCS}
	${MOC_SRCS}
	${UI_SRC}
)

SET_TARGET_PROPERTIES ( ${PROJECT_EXECUTABLES} PROPERTIES
	LINKER_LANGUAGE CXX
	INSTALL_RPATH "${CMAKE_INSTALL_PREFIX}/lib" 
)

TARGET_LINK_LIBRARIES ( rbdl-toolkit
	${QT_LIBRARIES}
	Qt5::Core
	Qt5::Gui
	Qt5::Widgets
	Qt5::3DCore
	Qt5::3DExtras
	Qt5::3DRender
	Qt5::3DInput
	${RBDL_LIBRARY}
	${RBDL_LUAMODEL_LIBRARY}
	
)

INSTALL ( TARGETS rbdl-toolkit RUNTIME DESTINATION bin )

FILE ( GLOB MESH_FILES meshes/*.obj )
INSTALL ( FILES ${MESH_FILES} DESTINATION share/rbdl-toolkit/meshes )
